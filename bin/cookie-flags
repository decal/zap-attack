#!/usr/bin/env ruby
# encoding: utf-8
#
# Form a unique list of names from HTTP response header fields 
#

require 'zap_attack'
require 'ipaddr'

include ZapAttack::API

params = Params.new
cookies = params.select { |h| h['type'] == 'cookie' }
cflags = []

cookies.each do |c|
  xflags = c['Flags']

  next if !xflags or xflags.empty?

  cflags << xflags
end

cflags.sort!
cflags.uniq!

puts cflags

exit 0
